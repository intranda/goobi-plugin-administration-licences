<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:x="http://myfaces.apache.org/tomahawk"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui"
	xmlns:jsf="http://xmlns.jcp.org/jsf">

	<composite:interface>
	</composite:interface>

	<composite:implementation>

		<style>
            .progress {
                border: 1px solid #EFAD4E;
                padding-left:0;
                padding-right:0;
                position: relative;
                margin-bottom: 0px;
            }
            .progress-bar {
                height: 100%;
                background-color: #EFAD4E;
                margin-top: 0px;
                line-height: 1.4;
                box-shadow: none;
                vertical-align: button;
            }
            .progress span {
                position: absolute;
                display: block;
                width: 100%;
                color: #666666;
                font-weight: bold;
             }
        </style>
		
		<h:panelGroup>
			<div class="row">
				<div class="col-sm-12">
					<div class="box box-color box-bordered lightgrey">
						<div class="box-title">
							<h3>
								<i class="fa fa-plug"></i>
								<h:outputText
									value="#{msgs[AdministrationForm.administrationPlugin.title]}" />
							</h3>
							<div class="actions">
								<h:form>
									<button
                                        jsf:id="reload"
                                        pt:aria-label="#{msgs.reload}"
                                        jsf:action="#{AdministrationForm.administrationPlugin.loadContracts}"
                                        class="btn btn-mini"
                                        title="#{msgs.reload}"
                                        jsf:rel="tooltip">
                                        <i class="fa fa-refresh font-white"></i>
                                        <f:passThroughAttribute
                                            name="data-toggle"
                                            value="tooltip" />
                                    </button>
								</h:form>
							</div>
							
						</div>
						<ui:fragment rendered="#{!LoginForm.hasRole('Plugin_administration_licences')}">
							<div class="box-content">
								<h:outputText
									styleClass="alert alert-danger alert-dismissable margin-bottom-10 margin-top-10"
									value="#{msgs.plugin_administration_missingPermission} Plugin_administration_licences"></h:outputText>
							</div>
						</ui:fragment>

						<ui:fragment rendered="#{LoginForm.hasRole('Plugin_administration_licences')}">
							<div class="box-content nopadding">
								<div class="dataTables_wrapper">
									<div class="dataTables_length">
										<h:outputText value="#{msgs.treffer}: #{AdministrationForm.administrationPlugin.contracts.size()}" />
									</div>
	
									<!-- Table -->
									<x:dataTable id="licences" styleClass="table table-hover table-nomargin dataTable table-bordered responsive" 
										var="item" value="#{AdministrationForm.administrationPlugin.contracts}">
	
										<h:column>
											<f:facet name="header">
												<h:outputText value="#{msgs.plugin_administration_licences_name}" />
											</f:facet>
											<h:outputText value="#{item.name}" />
										</h:column>
	
										<x:column styleClass="tableColumnWidthLong">
											<f:facet name="header">
												<h:outputText value="#{msgs.plugin_administration_licences_type}" />
											</f:facet>
											<h:outputText value="#{item.type}" />
										</x:column>

										<x:column styleClass="tableColumnWidthLong">
											<f:facet name="header">
												<h:outputText value="#{msgs.plugin_administration_licences_ordernumber}" />
											</f:facet>
											<h:outputText value="#{item.ordernumber}" />
										</x:column>

										<x:column styleClass="tableColumnWidthMid">
											<f:facet name="header">
												<h:outputText value="#{msgs.plugin_administration_licences_enabled}" />
											</f:facet>
											<h:panelGroup  rendered="#{!item.enabled}"  class="badge badge-intranda-red">
												<i class="fa fa-lock"></i> #{msgs.inactive}	
											</h:panelGroup>
	                                        <h:panelGroup class="badge badge-intranda-green" rendered="#{item.enabled}">
	                                            <i class="fa fa-unlock"></i> #{msgs.active}
	                                        </h:panelGroup>
										</x:column>
											
										<x:column styleClass="tableColumnMaxWidthLonger">
											<f:facet name="header">
												<h:outputText value="#{msgs.plugin_administration_licences_usage}" />
											</f:facet>
											<h:panelGroup class="col-sm-12 progress" id="resultProgress">
                                                <div class="progress-bar" role="progressbar"
                                                    aria-valuenow="#{item.usedPercent}"
                                                    aria-valuemin="0" aria-valuemax="100"
                                                    style="width:#{item.usedPercent}%">
                                                    <span>
                                                        <h:outputText
                                                            value="#{item.usedSize} #{msgs.of} #{item.size} - #{item.usedPercent}%" />
                                                    </span>
                                                </div>
                                            </h:panelGroup>
                                        </x:column>
	
									</x:dataTable>
								</div>
							</div>
						</ui:fragment>
					</div>
				</div>
			</div>
		</h:panelGroup>

	</composite:implementation>
</ui:composition>