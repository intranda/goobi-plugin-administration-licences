<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:composite="http://xmlns.jcp.org/jsf/composite"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:intranda="http://xmlns.jcp.org/jsf/composite/compositesPG"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:p="http://primefaces.org/ui"
	xmlns:jsf="http://xmlns.jcp.org/jsf"
	xmlns:section="http://goobi.io/section"
	xmlns:table="http://goobi.io/table"
	>

	<composite:interface>
	</composite:interface>

	<composite:implementation>
		<h:panelGroup>
			<ui:fragment rendered="#{!LoginForm.hasRole('Plugin_administration_licences')}">
				<div class="alert alert-danger">
					<h:outputText
						value="#{msgs.plugin_administration_missingPermission} Plugin_administration_licences"></h:outputText>
				</div>
			</ui:fragment>
			<ui:fragment rendered="#{LoginForm.hasRole('Plugin_administration_licences')}">
				<section:section type="neutral">
					<section:header icon="plug" title="#{msgs[AdministrationForm.administrationPlugin.title]}">
						<section:header-actions>
							<h:form>
								<button
									jsf:id="reload"
									pt:aria-label="#{msgs.reload}"
									jsf:action="#{AdministrationForm.administrationPlugin.loadContracts}"
									class="btn btn-mini"
									title="#{msgs.reload}"
									jsf:rel="tooltip">
									<span class="fa fa-refresh font-white" />
									<f:passThroughAttribute
										name="data-toggle"
										value="tooltip" />
								</button>
							</h:form>
						</section:header-actions>
					</section:header>
					<section:body padding="true">
						<table:wrapper>
							<table:filter>
								<table:hits>
									<h:outputText value="#{msgs.treffer}: #{AdministrationForm.administrationPlugin.contracts.size()}" />
								</table:hits>
							</table:filter>
							<table:table>
								<!-- Table -->
								<h:dataTable id="licences" styleClass="table table-hover table-nomargin dataTable table-bordered responsive"
									var="item" value="#{AdministrationForm.administrationPlugin.contracts}">

									<h:column>
										<f:facet name="header">
											<h:outputText value="#{msgs.plugin_administration_licences_name}" />
										</f:facet>
										<h:outputText value="#{item.name}" />
									</h:column>

									<h:column styleClass="tableColumnWidthLong">
										<f:facet name="header">
											<h:outputText value="#{msgs.plugin_administration_licences_type}" />
										</f:facet>
										<h:outputText value="#{item.type}" />
									</h:column>

									<h:column styleClass="tableColumnWidthLong">
										<f:facet name="header">
											<h:outputText value="#{msgs.plugin_administration_licences_ordernumber}" />
										</f:facet>
										<h:outputText value="#{item.ordernumber}" />
									</h:column>

									<h:column styleClass="tableColumnWidthMid">
										<f:facet name="header">
											<h:outputText value="#{msgs.plugin_administration_licences_enabled}" />
										</f:facet>
										<h:panelGroup  rendered="#{!item.enabled}"  class="badge badge-intranda-red my-auto">
											<span class="fa fa-lock" />
											<span>
												#{msgs.inactive}
											</span>
										</h:panelGroup>
										<h:panelGroup class="badge badge-intranda-green my-auto" rendered="#{item.enabled}">
											<span class="fa fa-unlock" />
											<span>
												#{msgs.active}
											</span>
										</h:panelGroup>
									</h:column>

									<h:column styleClass="tableColumnMaxWidthLonger">
										<f:facet name="header">
											<h:outputText value="#{msgs.plugin_administration_licences_usage}" />
										</f:facet>
										<div
											class="progress"
											jsf:id="resultProgress"
											role="progressbar"
											aria-valuenow="#{item.usedPercent}"
											aria-valuemin="0"
											aria-valuemax="100"
											>
											<div
												class="progress-bar"
												style="width:#{item.usedPercent}%">
												<h:outputText
													value="#{item.usedSize} #{msgs.of} #{item.size} - #{item.usedPercent}%" />
											</div>
										</div>
									</h:column>

								</h:dataTable>
							</table:table>
						</table:wrapper>
					</section:body>
				</section:section>
			</ui:fragment>
		</h:panelGroup>

	</composite:implementation>
</ui:composition>